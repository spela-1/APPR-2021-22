---
title: "Analiza kriminala v Sloveniji"
author: "Špela Bernardič"
output:
  html_document: default
  pdf_document:
    includes:
      in_header: lib/styles.sty
    latex_engine: xelatex
runtime: shiny
---

```{r setup, echo=FALSE, results='hide', message=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo=FALSE, message=FALSE, warning=FALSE)

# Uvoz vseh potrebnih knjižnic
source("lib/libraries.r", encoding="UTF-8")
```


## Izbira teme

V projektu sem analizirala kriminal v Sloveniji.
Opazovala sem število obsojenih glede na vrsto dejanja, spol, starostno skupino in leto.
Želela pa sem tudi povezati število obsojenih glede na socioekonomske kazalnike po raztličnih regijah oz. občinah po Sloveniji. Torej sem gledala povezavo med številom obsojenih in povprečno samooceno splošnega zadovoljstva z življenjem, stopnjo tveganja revščine, s stanovanjskimi razmerami in povprečno plačo.  

***

## Obdelava, uvoz in čiščenje podatkov

```{r uvoz}
source("uvoz/uvoz.r", encoding="UTF-8")
```

Podatke sem našla na Eurostatu in SiStatu, in jih uvozila kot CSV oz. HTML detoteke. Kasneje sem namesto tabele iz Eurostata raje uporabila samo podatke iz SiStata, saj so se zdeli bolj zanimivi (uvoz tabele iz Eurostata sem zakomentirala).

Podatke sem uredila v naslednje tabele:

1. _tabela "zlocinci" vsebuje podatke_:
  - vrsta kaznivega dejanja
  - spol
  - starostna skupina
  - leto (2013-2020)
  - število obsojenih
  
2. _tabela "tabela_r" združuje štiri tabele in vsebuje podatke_:
  - regija
  - leto (2012-2020)
  - število obsojenih na 1000 prebivalcev
  - povprečna samoocena zadovoljstva
  - stopnja tveganja revščine (Odstotek oseb, ki živijo v gospodinjstvih z ekvivalentnim (neto) razpoložljivim dohodkom, nižjim od praga tveganja revščine.)
  - stanovanjske razmere (Delež gospodinjstev, ki imajo težave s streho, ki pušča, z vlažnimi stenami/temelji/tlemi, s trhlimi okenskimi okvirji ali trhlimi tlemi.)

3. _tabela "tabela_o" združuje dve tabeli in vsebuje podatke_:
  - občina
  - leto (2008-2020)
  - število obsojenih na 1000 prebivalcev
  - povprečna plača
  
***
  
## Analiza in vizualizacija podatkov

```{r vizualizacija, results='hide'}
source("vizualizacija/vizualizacija.r", encoding="UTF-8")
```


```{r g1, echo=FALSE, fig.align='center'}
g1
```

V prvem grafu vidimo število obsojenih na 1000 prbivalcev po letih po slovenskih statističnih regijah.
Vidimo, da kriminal na 1000 prebivalcev skozi leta pada, opazimo pa lahko tudi kako Jugovzhodna regija izstopa glede na ostale statistične regije.


```{r g2, echo=FALSE, fig.align='center'}
g2
```

V naslednjem grafu sem želela preveriti, če je število obsojenih na 1000 prebivalcev v posamezni regiji odvisen od izbranih parametrov. Ti parametri so: Povpreča samoocena zadovoljstva z življenjem, stopnja revščine in delež stanovanj, ki so ocenjena kot slaba.
Ker se mi je zdelo, da lahko iz grafa opazim korelacijo, sem se odločila, da bom iste podatke kasneje uporabila pri izdelavi napovednega modela in preverila, če hipoteza drži.


```{r g4, echo=FALSE, fig.align='center'}
g4
```

S tem grafom sem želela pokazati, če katera od starostnih skupin močno izstopa po številu obsojenih. Vidimo, da je v starostni skupini do 20 let malo obsojenih. To je zato, ker  podatki zaobjemajo le polnoletne osebe. Manjše število obosjenih pa je tudi v starejših starostnih skupinah.


```{r g5, echo=FALSE, fig.align='center'}
g5
```

Zanimalo me je, če so določena kazniva dejanja bolj pogosta glede na demografske skupine.
Da bi bil graf bolj pregleden, sem vzela le deset najpogostejših zločinov.


```{r g6, echo=FALSE, fig.align='center'}
g6
```

Tako kot v drugem grafu, sem želela najti korelacijo med številom obsojenih na 1000 prebivalcev glede na izbrane parametre, tokrat glede na povprečno plačo. V tem primeru so podatki dani po občinah namesto statističnih regijah.
Ker pa nisem opazila nobene korelacije sem se odločila, da ne bom nadeljevala s to analizo.

***

## Zemljevid 

*Števila obsojenih na 1000 prebivalcev po občinah v letu 2015*

```{r map, echo=FALSE, fig.align='center'}
map
```



## Napredna analiza podatkov

### Razvrščanje v skupine

```{r analiza}
source("analiza/analiza.r", encoding="UTF-8")
```


Odločila sem se, da bom različna kazniva dejanja v letu 2020 razvrstila, glede na število obsojenih po starostnih skupinah. Kazniva dejanja, za katera ni bilo nobenega obsojenega v letu 2020, sem izpustila iz tabele. 
Razvrstila sem jih v skupine z dendogramom.
Število skupin pa sem določila s koleni.

```{r kolena, echo=FALSE, fig.align='center'}
kolena
```


### Napovedni model

Napovedni model sem naredila z istimi podatki kot je bil narsan graf "Število obsojenih glede na socioekonomska stanja". Sprva sam upoštevala le število obsojenih na 1000 prebivalcev v odvisnosti od treh izbranih parametrov (stopnja revscine, kvalitata stanovanj, samoocena zadovoljstva), kasneje pa sem ugotovila, da je za manjšo napako pomembna tudi regija in leto.
S prečnim preverjanjem sem izračunala napako za napovedna modela: 

- napaka za linearni napovedni model
```{r napaka.ln, echo=FALSE, fig.align='center'}
napaka.ln
```
- napaka za napovedni model narejen z naključnimi gozdovi 
```{r napaka.ng, echo=FALSE, fig.align='center'}
napaka.ng
```


Ker je bila napaka pri linearnem modelu manjša, sem pri tem še izračunala, koliko izbrane spremenljivke vplivajo na napoved
```{r moc, echo=FALSE, fig.align='center'}
moc
```

Izbrani parametri torej nekoliko vplivajo na število obsojenih, vendar manj kot sem pričakovala.


***

```{r shiny}
#shinyAppDir("shiny", options=list(width="100%", height=600))
```
